{"paragraphs":[{"text":"%spark\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.ml.classification.{RandomForestClassificationModel, RandomForestClassifier}\nimport org.apache.spark.ml.classification.LogisticRegression\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.linalg.DenseVector\nimport org.apache.spark.sql.functions.udf\nimport org.apache.spark.sql.functions.rand\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.ml.classification.MultilayerPerceptronClassifier\nimport scala.collection.JavaConversions._\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.ml.feature.Word2Vec\nimport org.apache.spark.ml.feature.Word2VecModel\nimport org.apache.spark.ml.linalg.Vector\nimport org.apache.spark.sql.Row\nimport org.apache.spark.storage.StorageLevel\n\n\n\nprintln(\"Scala version: \" + util.Properties.versionString);\nprintln(\"Spark version: \" + sc.version);\nprintln(\"Java version: \" + System.getProperty(\"java.version\"));","user":"anonymous","dateUpdated":"2020-05-10T10:54:39+0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Scala version: version 2.11.12\nSpark version: 2.4.4\nJava version: 1.8.0_181\nimport org.apache.spark.SparkContext\nimport org.apache.spark.ml.classification.{RandomForestClassificationModel, RandomForestClassifier}\nimport org.apache.spark.ml.classification.LogisticRegression\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.linalg.DenseVector\nimport org.apache.spark.sql.functions.udf\nimport org.apache.spark.sql.functions.rand\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.ml.classification.MultilayerPerceptronClassifier\nimport scala.collection.JavaConversions._\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.ml.feature.Word2Vec\nimport org.apache.spark.ml.feature.Word2VecModel\nimport org.apache.spark.ml.linalg.Vector\nimport org.apache.spark.sql.Row\nimport org...."}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022968_499956964","id":"20190505-221345_607136256","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T10:54:39+0800","dateFinished":"2020-05-10T10:54:39+0800","status":"FINISHED","focus":true,"$$hashKey":"object:433"},{"text":"%spark\ndef splitFunc (textLine: String) : Array[String] = {return textLine.toLowerCase.split(\" \");}\nval splitUdf = udf(splitFunc _)\n\ndef ExtractVector(word: String, model: Word2VecModel) : Array[Double] = {return model.getVectors.filter($\"word\" === word).select(\"vector\").collect().apply(0).apply(0).asInstanceOf[DenseVector].toArray;}; \n\ndef VectorPlus(a : Array[Double], b: Array[Double]) : Array[Double] = { return a.zip(b).map(x => x._1 + x._2); };\ndef VectorMinus(a : Array[Double], b: Array[Double]) : Array[Double] = { return a.zip(b).map(x => x._1 - x._2); };","user":"anonymous","dateUpdated":"2020-05-10T10:54:41+0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34msplitFunc\u001b[0m: \u001b[1m\u001b[32m(textLine: String)Array[String]\u001b[0m\n\u001b[1m\u001b[34msplitUdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = UserDefinedFunction(<function1>,ArrayType(StringType,true),Some(List(StringType)))\n\u001b[1m\u001b[34mExtractVector\u001b[0m: \u001b[1m\u001b[32m(word: String, model: org.apache.spark.ml.feature.Word2VecModel)Array[Double]\u001b[0m\n\u001b[1m\u001b[34mVectorPlus\u001b[0m: \u001b[1m\u001b[32m(a: Array[Double], b: Array[Double])Array[Double]\u001b[0m\n\u001b[1m\u001b[34mVectorMinus\u001b[0m: \u001b[1m\u001b[32m(a: Array[Double], b: Array[Double])Array[Double]\u001b[0m\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022969_1647067825","id":"20191202-050026_1853454161","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T10:54:41+0800","dateFinished":"2020-05-10T10:54:42+0800","status":"FINISHED","$$hashKey":"object:434"},{"text":"%spark\n//var raw_hp_sample : DataFrame =  spark.read.parquet(\"/Users/zihaozhang/zeppelin/HP.csv\").withColumn(\"text3\", splitUdf($\"clean_text\")).orderBy(rand()).limit(1000 * 1000);\n//var hp_sample : DataFrame =  spark.read.csv(\"/Users/zihaozhang/zeppelin/HP.csv\").option(header=\"true\")\n//var hp_sample: DataFrame =  spark.read.format(\"csv\").option(\"header\", \"true\").option(\"inferSchema\", true).load(\"/Users/zihaozhang/zeppelin/HP.csv\")\nvar hp_sample: DataFrame =  spark.read.format(\"csv\").option(\"header\", \"true\").option(\"inferSchema\", true).load(\"/Users/zihaozhang/zeppelin/HP_full.csv\")\n//hp_sample.write.parquet(\"/Users/zihaozhang/zeppelin/HP\")\n//hp_sample.registerTempTable(\"hp_sample\")\n//hp_sample.count();","user":"anonymous","dateUpdated":"2020-05-10T10:54:43+0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mhp_sample\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [sentences: string]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=212","$$hashKey":"object:2759"},{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=213","$$hashKey":"object:2760"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022970_1668686866","id":"paragraph_1588982167685_467041353","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T10:54:43+0800","dateFinished":"2020-05-10T10:54:44+0800","status":"FINISHED","$$hashKey":"object:435"},{"text":"%spark\nvar raw_hp_sample : DataFrame =  spark.read.parquet(\"/Users/zihaozhang/zeppelin/HP\").withColumn(\"text3\", splitUdf($\"sentences\")).orderBy(rand(9)).limit(1000 * 1000)\n//var raw_hp_sample : DataFrame =  spark.read.parquet(\"/Users/zihaozhang/zeppelin/HP\").withColumn(\"text3\", \"sentences\").orderBy(rand()).limit(1000 * 1000)\nraw_hp_sample.registerTempTable(\"raw_hp_sample\")\nraw_hp_sample.show();","user":"anonymous","dateUpdated":"2020-05-10T10:54:45+0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[33mwarning: \u001b[0mthere was one deprecation warning; re-run with -deprecation for details\n+--------------------+--------------------+\n|           sentences|               text3|\n+--------------------+--------------------+\n|it helps with the...|[it, helps, with,...|\n|i havent eaten fo...|[i, havent, eaten...|\n|uncle vernon mutt...|[uncle, vernon, m...|\n|her husband a thi...|[her, husband, a,...|\n|he had patched up...|[he, had, patched...|\n|you remember the ...|[you, remember, t...|\n|here� cried hermi...|[here�, cried, he...|\n|he had the horrib...|[he, had, the, ho...|\n|er yeh might want...|[er, yeh, might, ...|\n|and they ended up...|[and, they, ended...|\n|i didnt mumbled h...|[i, didnt, mumble...|\n|you c cant howled...|[you, c, cant, ho...|\n|he strode away fr...|[he, strode, away...|\n|then if youre sti...|[then, if, youre,...|\n|fawkes was waitin...|[fawkes, was, wai...|\n|he rose up in the...|[he, rose, up, in...|\n|but just then bag...|[but, just, then,...|\n|the booksshe was ...|[the, booksshe, w...|\n|did this mean tha...|[did, this, mean,...|\n|he was missing to...|[he, was, missing...|\n+--------------------+--------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mraw_hp_sample\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [sentences: string, text3: array<string>]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=214","$$hashKey":"object:2841"},{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=215","$$hashKey":"object:2842"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022970_906707438","id":"paragraph_1588988282849_384022735","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T10:54:45+0800","dateFinished":"2020-05-10T10:54:49+0800","status":"FINISHED","$$hashKey":"object:436"},{"text":"%sql\n\nSELECT *\nFROM raw_hp_sample\nLIMIT 10","user":"anonymous","dateUpdated":"2020-05-10T10:54:53+0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sentences":"string","text3":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sentences\ttext3\nit helps with the stingin yeh know\tWrappedArray(it, helps, with, the, stingin, yeh, know)\ni havent eaten for nearly four hundred years said the ghost\tWrappedArray(i, havent, eaten, for, nearly, four, hundred, years, said, the, ghost)\nuncle vernon muttered preposterous but dumbledore ignored himnow as you already know the wizard called lord voldemort was returned to this country\tWrappedArray(uncle, vernon, muttered, preposterous, but, dumbledore, ignored, himnow, as, you, already, know, the, wizard, called, lord, voldemort, was, returned, to, this, country)\nher husband a thin balding redhaired man who wore hornrimmed glasses looked around and jumped to his feet\tWrappedArray(her, husband, a, thin, balding, redhaired, man, who, wore, hornrimmed, glasses, looked, around, and, jumped, to, his, feet)\nhe had patched up his wandwith some borrowed spellotape but it seemed to be damaged beyondrepair\tWrappedArray(he, had, patched, up, his, wandwith, some, borrowed, spellotape, but, it, seemed, to, be, damaged, beyondrepair)\nyou remember the shape and color of lily evanss eyes i am sure\tWrappedArray(you, remember, the, shape, and, color, of, lily, evanss, eyes, i, am, sure)\nhere� cried hermione again a few moments later from out of the darkness\tWrappedArray(here�, cried, hermione, again, a, few, moments, later, from, out, of, the, darkness)\nhe had the horrible impression that he was slowly turning into a kind of aerial that was tuned in to tiny fluctuations in voldemorts mood and he was sure he could date this increased sensitivity firmly from his first occlumency lesson with snape\tWrappedArray(he, had, the, horrible, impression, that, he, was, slowly, turning, into, a, kind, of, aerial, that, was, tuned, in, to, tiny, fluctuations, in, voldemorts, mood, and, he, was, sure, he, could, date, this, increased, sensitivity, firmly, from, his, first, occlumency, lesson, with, snape)\ner yeh might want ter put on yer dragonhide gloves jus as an extra precaution like\tWrappedArray(er, yeh, might, want, ter, put, on, yer, dragonhide, gloves, jus, as, an, extra, precaution, like)\nand they ended up married\tWrappedArray(and, they, ended, up, married)\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=216","$$hashKey":"object:2888"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022970_-2123739058","id":"paragraph_1588989874120_718369415","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T10:54:53+0800","dateFinished":"2020-05-10T10:54:55+0800","status":"FINISHED","$$hashKey":"object:437"},{"text":"%spark\nvar start = System.currentTimeMillis();\nval word2Vec4 = new Word2Vec()\n  .setInputCol(\"text3\")\n  .setOutputCol(\"result\")\n  //.setVectorSize(32)\n  .setVectorSize(16)\n  .setMinCount(1)\n  .setSeed(9)\nval model4 = word2Vec4.fit(raw_hp_sample.limit(80 * 1000))\n//val model4 = word2Vec4.fit(hp_sample.limit(10 * 1000))\nvar end = System.currentTimeMillis();\n\nprintln(\"Fitting time: \" + (end - start))","user":"anonymous","dateUpdated":"2020-05-10T11:25:48+0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Fitting time: 15751\n\u001b[1m\u001b[34mstart\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1589081148293\n\u001b[1m\u001b[34mword2Vec4\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.Word2Vec\u001b[0m = w2v_94df580668ea\n\u001b[1m\u001b[34mmodel4\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.Word2VecModel\u001b[0m = w2v_94df580668ea\n\u001b[1m\u001b[34mend\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1589081164044\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=231","$$hashKey":"object:11098"},{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=232","$$hashKey":"object:11099"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022970_-602136940","id":"paragraph_1588989147961_909543100","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T11:25:48+0800","dateFinished":"2020-05-10T11:26:04+0800","status":"FINISHED","$$hashKey":"object:438"},{"text":"%spark\nvar output_vector = VectorPlus(VectorMinus(ExtractVector(\"harry\", model4), ExtractVector(\"gryffindor\", model4)),  ExtractVector(\"slytherin\", model4));\nz.show(model4.findSynonyms(Vectors.dense(output_vector), 5))","user":"anonymous","dateUpdated":"2020-05-10T11:25:50+0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"word":"string","similarity":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"word\tsimilarity\nsnape\t0.895075261592865\nmalfoy\t0.8907024264335632\nlupin\t0.8680430054664612\nmoody\t0.8668643236160278\nbagman\t0.8389947414398193\n"},{"type":"TEXT","data":"\u001b[1m\u001b[34moutput_vector\u001b[0m: \u001b[1m\u001b[32mArray[Double]\u001b[0m = Array(0.10033231973648071, -0.2819797694683075, -0.24629198759794235, 0.6180471777915955, -0.1923130452632904, -0.23633424937725067, -0.1471086535602808, -0.11161714978516102, 0.023624688386917114, 0.1407913826406002, -0.3465486168861389, 0.02394497860223055, -0.49971291422843933, -0.023215387016534805, 0.14508928172290325, 0.4230225384235382)\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588993022970_-2112272878","id":"paragraph_1588989789296_642277387","dateCreated":"2020-05-09T10:57:02+0800","dateStarted":"2020-05-10T11:25:50+0800","dateFinished":"2020-05-10T11:26:05+0800","status":"FINISHED","$$hashKey":"object:439"},{"text":"%spark\nvar output_vector = VectorPlus(VectorMinus(ExtractVector(\"wizard\", model4), ExtractVector(\"male\", model4)),  ExtractVector(\"female\", model4));\nz.show(model4.findSynonyms(Vectors.dense(output_vector), 5))","user":"anonymous","dateUpdated":"2020-05-10T11:26:11+0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"word":"string","similarity":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1589079588202_745749438","id":"paragraph_1589079588202_745749438","dateCreated":"2020-05-10T10:59:48+0800","status":"FINISHED","focus":true,"$$hashKey":"object:5979","dateFinished":"2020-05-10T11:26:12+0800","dateStarted":"2020-05-10T11:26:11+0800","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"word\tsimilarity\nwizard\t0.9655999541282654\npractical\t0.9294725656509399\nwitch\t0.9082695841789246\ncentury\t0.9073298573493958\nf\t0.8991310596466064\n"},{"type":"TEXT","data":"\u001b[1m\u001b[34moutput_vector\u001b[0m: \u001b[1m\u001b[32mArray[Double]\u001b[0m = Array(0.6425523683428764, 0.6020353948697448, 0.2270202562212944, -0.006454095244407654, 0.17015516012907028, 0.14744557067751884, 0.07328504417091608, -0.4370339661836624, 0.15678468020632863, -0.5451871268451214, 0.14650712814182043, 0.35383931174874306, 0.06342553906142712, -0.15741409547626972, 0.1417897092178464, 0.4317496195435524)\n"}]}},{"text":"%spark\nvar start = System.currentTimeMillis();\nval word2Vec5 = new Word2Vec()\n  .setInputCol(\"text3\")\n  .setOutputCol(\"result\")\n  .setVectorSize(64)\n  //.setVectorSize(16)\n  .setMinCount(3)\n  .setSeed(9)\nval model5 = word2Vec5.fit(raw_hp_sample.limit(80 * 1000))\n//val model4 = word2Vec4.fit(hp_sample.limit(10 * 1000))\nvar end = System.currentTimeMillis();","user":"anonymous","dateUpdated":"2020-05-10T11:07:01+0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mstart\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1589080021360\n\u001b[1m\u001b[34mword2Vec5\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.Word2Vec\u001b[0m = w2v_61d0d455dc99\n\u001b[1m\u001b[34mmodel5\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.Word2VecModel\u001b[0m = w2v_61d0d455dc99\n\u001b[1m\u001b[34mend\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1589080041293\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=227","$$hashKey":"object:9657"},{"jobUrl":"http://192.168.0.106:4040/jobs/job?id=228","$$hashKey":"object:9658"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1589068351254_-1880687414","id":"paragraph_1589068351254_-1880687414","dateCreated":"2020-05-10T07:52:31+0800","dateStarted":"2020-05-10T11:07:01+0800","dateFinished":"2020-05-10T11:07:21+0800","status":"FINISHED","$$hashKey":"object:440"},{"text":"%spark\nvar output_vector = VectorPlus(ExtractVector(\"tom\", model5), ExtractVector(\"old\", model5));\nz.show(model5.findSynonyms(Vectors.dense(output_vector), 5))","user":"anonymous","dateUpdated":"2020-05-10T11:07:22+0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"word":"string","similarity":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"word\tsimilarity\nold\t0.9070389866828918\nmuggle\t0.752226710319519\npoor\t0.7368013262748718\nlegislation\t0.7152921557426453\ncomplex\t0.7124474048614502\n"},{"type":"TEXT","data":"\u001b[1m\u001b[34moutput_vector\u001b[0m: \u001b[1m\u001b[32mArray[Double]\u001b[0m = Array(0.023397982120513916, -0.125678276643157, -0.13546167127788067, -0.061249079182744026, -0.42470861971378326, -0.05583694949746132, 0.1546132192015648, 0.304912693798542, -0.1327977180480957, -0.03907182067632675, 0.1871364712715149, -0.02106921374797821, -0.0917314663529396, 0.28594204783439636, -0.11314204335212708, -0.21326500922441483, -0.023373425006866455, 0.5224860608577728, 0.03721099533140659, -0.1342721339315176, -0.025591716170310974, -0.2593632936477661, -0.22935528308153152, 0.036723967641592026, 0.3411208614706993, -0.07432972826063633, -0.39718618988990784, 0.2544722557067871, -0.2710445448756218, -0.07860143482685089, 0.0053591299802064896, -0.04606706369668245, 0.008003972470760345, -0.24620922654867172, 0.03..."}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1589076476249_-25409063","id":"paragraph_1589076476249_-25409063","dateCreated":"2020-05-10T10:07:56+0800","dateStarted":"2020-05-10T11:07:03+0800","dateFinished":"2020-05-10T11:07:21+0800","status":"FINISHED","$$hashKey":"object:441"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-05-10T10:08:18+0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1589076498097_1074029420","id":"paragraph_1589076498097_1074029420","dateCreated":"2020-05-10T10:08:18+0800","status":"READY","$$hashKey":"object:442"}],"name":"word2vec_HP_w14g4","id":"2FA387EXC","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/word2vec_HP_w14g4"}